\documentclass[a4paper]{article}

\usepackage{fullpage} % Package to use full page
\usepackage{parskip} % Package to tweak paragraph skipping
\usepackage{tikz} % Package for drawing
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[MeX]{polski}

\title{Notatki z kursu Sieci Komputerowe}
\author{Małgorzata Dymek}
\date{2018/19, semestr letni}

\begin{document}
\maketitle



% \section{Laboratorium 1}
% Zasady zaliczenia: trzy kolokwia (dwa pisane (adresacja + routing i switching)  + jedno praktyczne ( naprawienie zepsutych rzeczy ) )
% \begin{itemize}
%     \item dwa kolokwia pisemne (20 + 20)
%     \begin{itemize}
%         \item adresacja
%         \item routing i switching
%     \end{itemize}
%     \item kolokwium praktyczne (30)
%     \begin{itemize}
%         \item naprawienie zepsutych rzeczy
%     \end{itemize}
%     \item obecność - 15*2 = 30
% \end{itemize}
% W sumie 100 punktów.
%
% \begin{tabular}{|c|c|}
% \hline
% 0 - 50 & ndst\\
% \hline
% 51 - 60 & dst\\
% \hline
% 61 - 70 & dst+\\
% \hline
% 71 - 80 & db\\
% \hline
% 81 - 90 & db+\\
% \hline
% 91 - 100 & bdb\\
% \hline
% \end{tabular}
%
%
% Bridge - fizyczne połączenie do fizycznej karty sieciowej (kabel rj5) jakby jedna szyna (wszystko do fizycznej wpada do wirtualnej)
% Host only - tylko z komputera bez wyjścia na zewnątrz
% NAP - adres z fizycznego komputera, nie z wirtualki
%
% settings - vnet3 - nr wirtualnego switcha
% brama domyślna - wyjście na świat - pc2
%
% \section{Laboratorium 2}
% Routing
%
% menedżer urządzeń -> nr COMu -> PuTTy serial COM -> konsola - wpisać no ->



\section{Podstawowe pojęcia}
\textbf{Sieć komputerowa} - zbiór połączonych komputerów i urządzeń z możliwością komunikacji. Obejmują	również	wszystko co	umożliwia
komunikację i współdzielenie zasobów, w szczególności oprogramowanie, protokoły komunikacyjne, media transmisyjne (kable).
\\
Dwie główne kategorie sieci:
\begin{itemize}
    \item \textbf{LAN} - Local Area Networks
    \item \textbf{WAN} - Wide Area Networks
\end{itemize}

Przybliżone  kryterium	 rozróżnienia: odległości między łączonymi	komputerami. Są techlonolgie charakterystyczne dla
sieci	lokalnych (Gigabit Ethernet),	inne dla sieci rozległych (T1,	E1	czy	Frame	Relay).
\\
Inny podział wg kryterium odległości:
\begin{itemize}
    \item \textbf{Nanoscale} – obecnie przedmiot badań, zastosowanie w nanomedycynie (IEEE).
    \item \textbf{NFC} (Near Field Communication) – odległości	rzędu	centymetrów.
    \item \textbf{BAN} (Body Area Network),	\textbf{WBAN} (Wireless	BAN),	inaczej to	BSN	(Body	Sensor	Network) – łączenie	czujników,	„wearable	devices”.
    \item \textbf{PAN} (Personal Area Network) – od centymetrów	do	kilku metrów (bezprzedowowe: IrDA,	Bluetooth,	Wireless USB,	oraz	przewodowe	jak	USB,	FireWire,
Thunderbolt).
    \item \textbf{NAN} (Near-me	Area	Network)	– komunikacja	między	urządzeniami bezprzewodowymi, które	są	blisko	siebie. Ścieżka	komunikacyjna	między	urządzeniami	w	jednej	sieci	NAN	może jednak	być	długa	i	może	nawet	obejmować	technologie	sieci	WAN,	np.	jeśli	do	NAN	należą telefony	zarejestrowane	w	różnych	firmach	telekomunikacyjnych.
    \item \textbf{SAN} (Storage	Area	Network).
    \item \textbf{CAN} – Campus	Area	Network,	sieci	kampusowe.
    \item \textbf{MAN} (Metropolitan	Area	Network)	– obejmuje	obszar	miasta,	dużego	kampusu.
\end{itemize}

\textbf{Internet jest globalną	 siecią	 komputerową} złożoną z	 wielu	 sieci	 komputerowych wykorzystujących	 \textbf{protokół IP} (zestaw protokołów TCP/IP). Od strony	 logicznej	 Internet można	identyfikować	z	\textbf{przestrzenią	adresową	protokołu	IP}	 (są	w użyciu	dwie wersje:	IPv4 i nowsza IPv6).\\
Na	każdą	sieć	komputerową	składają	się	sprzętowe	oraz	programowe	elementy	składowe.

\subsection{Sprzętowe	elementy	składowe	sieci	komputerowych}
Podstawowymi	elementami	sprzętowymi	są:
\begin{itemize}
    \item \textbf{Nośniki	transmisji}	(media	transmisyjne)\\
    Nośniki	 transportu	 sygnałów	 przesyłanych	 przez	 sieć. Są to na przykład kable koncentryczne, tzw.
    skrętki, kable miedziane,  kable	 światłowodowe,	 ale	 też	 przestrzeń (przesyłanie	fal	radiowych,	mikrofal,	światła).
    \item \textbf{Urządzenia	dostępu do	nośnika}\\
    Są odpowiedzialne za	formatowanie danych	tak, by nadawały się do	 przesyłania poprzez nośnik	 transmisji, umieszczanie	 tych	 danych	 w nośniku	transmisji	oraz	odbieranie	odpowiednio zaadresowanych	danych	(np. karty sieciowe w sieci LAN).
    \item \textbf{Urządzenia	wzmacniające,	filtrujące	i	kierujące	przesyłane	sygnały},	np.	przełączniki warstwy	drugiej, routery.\\
    Sygnały	 umieszczane w	 nośniku transmisji ulegają zakłóceniom.
    \begin{itemize}
        \item \textbf{Tłumienie} (osłabienie siły sygnału)\\
        Sposoby unikania tłumienia:  ograniczenie	 długości	 połączeń	 (kabli), zainstalowanie	urządzenia,	które odczytuje	przesyłane	sygnały,	wzmacnia	je	i
        wysyła	z	powrotem	do	sieci.
        \item \textbf{Zniekształcenie} (niepożądanazmiana kształtu przebiegu czasowego)\\
        Przeciwdziałanie	 zniekształceniom polega	 na	 przestrzeganiu	 zaleceń dotyczących	 nośnika	 (odpowiedni typ nośnika, poprawna instalacja, odpowiednie	 długości	 przewodów) oraz korzystaniu z protokołów obsługujących korektę	błędów	transmisji.
    \end{itemize}
    Zadania	filtrujące	i	kierujące	sygnały	spełniają	takie	urządzenia	jak	mosty (pomosty,	bridges już	 raczej	 nie	 używane),	 koncentratory (hubs)	 przełączniki (switches), punkty	 dostępowe (access points), routery (routers),	bramy (gateways).
\end{itemize}

Karty	sieciowe	pakują	dane	w	tzw.	ramki. Ramki	są	podstawowymi	porcjami	danych	przesyłanymi	w	sieciach	komputerowych.


\subsection{Programowe	elementy	składowe	sieci	komputerowych.}
Elementami	programowymi	sieci	są:
\begin{itemize}
    \item \textbf{Protokoły	 komunikacyjne} (sieciowe)\\
    Zestawy standardów i zasad obowiązujących przy	 przesyłaniu danych	przez	sieć. Określają sposoby komunikowania się urządzeń	i	programów.
    \item \textbf{Oprogramowanie	komunikacyjne}\\
    Implementuje protokoły sieciowe. Są to programy	 umożliwiające	 użytkownikom	 korzystanie	 z
    sieci	 komputerowych	 np. program telnet, przeglądarki WWW, klienci pocztowi, oprogramowanie	umożliwiające mapowanie	dysków	sieciowych	itd.
    \item \textbf{Programy	 poziomu	 sprzętowego}\\
    Sterują pracą elementów	 sprzętowych. Sterowniki, programy	 obsługi, mikroprogramy umożliwiające	działanie	takich	urządzeń,	jak	karty	sieciowe.
\end{itemize}

\subsection{Ramki}
Dane przesyłane są w \textbf{porcjach zwanych ramkami}. Urządzenie	zapewniające dostęp	do nośnika przesyła	pewne sygnały, które są \textbf{interpretowane jako bity}. Od strony	logicznej wysyłany	ciąg bitów zawiera	pewne informacje i może	być	podzielony na porcje zwane \textbf{polami}.

Typowa ramka zawiera następujące pola:
\begin{itemize}
    \item ogranicznik początku ramki (jest	to	ustalony	wzór	bitów)
    \item tzw.	adres fizyczny nadawcy (źródła	danych)
    \item adres	fizyczny odbiorcy (miejsca	docelowego)
    \item dane
    \item ogranicznik końca	ramki (sekwencja	kontrolna	ramki).
\end{itemize}
Ogranicznik	 początku ramki być poprzedzony lub może zawierać tzw. \textbf{preambułę}, która w pewnych technologiach sieciowych jest stosowana do synchronizacji nadajnika i
odbiornika. Wielkość pól określana jest w oktetach (8 bitów, uniknięcia niejednoznaczności "bajtu" mogącego mieć więcej bitów). \textbf{Kapsułkowanie} - wstawienie danych do struktury ramki. Istnieją różne formaty ramek, różne sposoby kapsułkowania i różne sposoby fizycznego adresowania komputerów.

\section{Topologia sieci lokalnych}
Dwa rodzaje topologii:
\begin{itemize}
    \item Topologie fizyczne
    \item Topologie logiczne
\end{itemize}

Jeżeli przy fizycznej topologii gwiazdy komputer przesyła dane bezpośrednio do komputera docelowego (przełącznik), to mamy logiczną topologię gwiazdy. Jeżeli ramka jest wysyłana do wszystkich dostępnych komputerów (koncentrator), to logicznie jest to topologia magistrali.

\subsection{Komunikacja między komputerami}

Założenia:
\begin{itemize}
    \item Komputer źródłowy - Komputer 1: IP1, MAC1
    \item Komputer docelowy - Komputer 2: IP2, MAC2
\end{itemize}
Połączone switchem. Na komputerze docelowym  jest serwer strony WWW2.

Jeżeli na komputerze 1 ktoś spróbuje otworzyć WWW2, to:

\begin{itemize}
    \item Zadziała system DNS: komputer	1 skontaktuje się ze swoim serwerem	DNS i zapyta jaki jest adres IP	komputera związanego z nazwą domenową WW2. Serwer DNS znajdzie	odpowiedni adres w swoich zasobach i odeśle informację do	komputera 1.
    \item Przeglądarka utworzy komunikat (wg protokołu	HTTP).	Do komunikatu zostanie dodany nagłówek	(wg	protokołu TCP),	który zawiera m.in.	port docelowy (standardowo	serwery
    WWW	wykorzystują port o numerze	80)	oraz port źródłowy (przeglądarka wykorzystuje porty	dynamicznie	przydzielane, zwykle o „wysokich” numerach). Komunikat razem z dołączonym	nagłówkiem	TCP	nazywa	się	segmentem	TCP.
    \item Do segmentu TCP zostanie dodany nagłówek I – w ten sposób	powstanie pakiet (datagram) IP.	Nagłówek IP	zawiera	m.in. adres	IP	źródłowy (IP1) i adres P docelowy (IP2).
    \item Pakiet  musi być przesłany w ramce. Do pakietu musi zostać dodany nagłówek ramki, zawierający	źródłowy adres MAC (MAC1 – komputer	1 tworzący ramkę zna swój adres	MAC)	 oraz docelowy adres	MAC (powinien to być MAC2). \textbf{Komputer 1 nie zna adresu MAC komputera 2}. Zna	 tylko jego	 adres IP. W IPv4 do poznania adresu docelowego MAC wykorzystywany jest \textbf{protokół ARP} – Address	 Resolution	 Protocol.
    \begin{itemize}
        \item Komputer 1 wysyła specjalną ramkę	\textbf{ARP Request} (zapytanie	ARP, ramka ta NIE zawiera w	pakietu	IP), która ma adres	docelowy składający	się	z samych jedynek (48	jedynek: ffff-ff-ff-ff-ff).	Adres	ten	nazywa	się	\textbf{adresem	rozgłoszeniowym}. Ramka ARP Request jest przesyłana przez przełącznik do wszystkich przyłączonych komputerów. Ramka ta zawiera zapytanie o adres MAC	komputera,	którego adres IP jest przesyłany w ramce.
        \item Każdy	komputer przyłączony do	przełącznika ma	obowiązek odebrać ramkę	wysłaną na	adres rozgłoszeniowy MAC. Jednak tylko komputer o zadanym IP odpowie na ARP Request.
        \item Odpowiedź to	specjalna ramka \textbf{ARP	Reply}	(odpowiedź	ARP).	Odpowiedź	ARP	jest wysyłana na adres MAC komputera 1.
    \end{itemize}
    \item Po tym, jak komputer 1 pozna adres MAC komputera 2, może już zbudować ramkę przeznaczoną do komputera 2. Ramka ta zawiera wcześniej zbudowany pakiet IP (który z
    kolei zawiera segment TCP, który z kolei zawiera komunikat HTTP). Ramka	jest wysyłana do przełącznika, a przełącznik dostarcza ją tylko	do komputera 2.
    \begin{itemize}
        \item Przełącznik uczy się adresów MAC przyłączonych komputerów i routerów i zapamiętuje w tablicy przypisanie adresu MAC do konkretnego swojego portu. Jeśli przełącznik dostanie ramkę ze znanym mu	 adresem MAC, to kieruje tę ramkę tylko do odpowiedniego portu, w przeciwnym wypadku wysyła kopię ramki do wszystkich swoich portów (z	wyjątkiem tego, na którym	dostał ramkę).
    \end{itemize}
    \item Komputer 2 (jego karta sieciowa) odbiera ramkę, sprawdza adres MAC docelowy i sumę kontrolną, po czym „wyjmuje” z ramki pakiet IP. Sprawdza adres docelowy IP i „wyjmuje”	z pakietu segment TCP. Sprawdza do którego portu należy przekazać zawartość (komunikat HTTP) i ostatecznie „wyjmuje” komunikat http z segmentu i przekazuje do portu 80, na którym nasłuchuje serwer WWW.
    \item Serwer WWW skonstruuje odpowiedź – stronę WWW zapisaną z wykorzystaniem języka HTML). Strona ta zostanie umieszczona w komunikacie http, który następnie musi być przesłany do komputera 1. Mechanizm jest analogiczny jak poprzednio.
\end{itemize}
W rzeczywistości zanim może zostać przesłany segment TCP, komputery wykorzystujące ten protokół do komunikacji, muszą zbudować tzw. połączenie TCP.


\begin{tabular}{|c|c|c|c|c|}
\hline
Nagłówek ramki & Nagłówek IP & Nagłówek TCP & Komunikat HTTP & Suma kontrolna\\
(numery MAC) & (numery IP) & (numery portów) & & \\
& 20 bajtów & 20 bajtów & & 4 bajty\\
\hline
\end{tabular}

\textbf{W przypadku komunikacji między komputerami rozdzielonymi przynajmniej jednym routerem}
\begin{itemize}
    \item Wszystko do skonstruowania pakietu IP włącznie działa tak samo. Komputer tworzący ramkę musi więc wykorzystując ARP Request poznać
    MAC adres routera, czyli swojej \textbf{bramy domyślnej} (default gateway). Stąd elementem konfiguracji komputera jest podanie mu nie tylko
    jego adresu IP, ale również adresu IP bramy.
    \item Ramka jest wysyłana do routera.
    \item Router (brama) po otrzymaniu ramki „wyjmuje” z niej pakiet IP, zagląda do nagłówka i sprawdza jaki jest adres docelowy IP. Na podstawie
    tego adresu i tablicy routowania wyznacza router następnego skoku i konstruuje i wysyła do niego nową ramkę, w której umieszcza przesyłany pakiet IP. Analogicznie aż pakiet dotrze w kolejnych ramkach do docelowej sieci i do docelowego komputera.
\end{itemize}

\subsection{Adresacja IPv4}

Adres IP jest przypisywany do karty sieciowej, nie do komputera.

Są \textbf{trzy typy adresów IPv4}:
\begin{itemize}
    \item \textbf{Adresy jednostkowe} (unicast) – pojedynczy interfejs sieciowy (komunikacja one-to-one).
    \item \textbf{Adresy rozgłoszeniowe} (broadcast) – wszystkie węzły w tym samym segmencie sieci (one-to-everyone).
    \item \textbf{Adresy grupowe} (multicast) – jeden lub wiele komputerów w jednej lub w różnych segmentach sieci (one-to-many).
\end{itemize}

W \textbf{adresie IP} zapisanym binarnie można wyróżnić \textbf{dwie części}:
\begin{itemize}
    \item \textbf{Identyfikator sieci} (Network ID) - pewna liczba bitów z lewej strony adresu
    \item \textbf{Identyfikator hosta} (Host ID) - pozostałe bity.
\end{itemize}
Terminem host określa się komputer, który jest końcowym konsumentem usług sieciowych.

\textbf{Granica} między identyfikatorem sieci a identyfikatorem hosta może być wyznaczona przez
tzw. \textbf{maskę sieci}.

\textbf{Identyfikator sieci}
\begin{itemize}
    \item \textbf{nie} może się składać z \textbf{samych jedynek}.
    \item \textbf{nie} może się składać z \textbf{samych zer}.
    \item \textbf{nie może się powtarzać} w złożonej sieci.
    \item W \textbf{pierwszym oktecie} adresu \textbf{nie} może się znaleźć wartość \textbf{127} (jest ona zarezerwowana dla adresu tzw. pętli zwrotnej).
\end{itemize}

\textbf{Identyfikator hosta}
\begin{itemize}
    \item \textbf{nie} może się składać z \textbf{samych jedynek}.
    \item \textbf{nie} może się składać z \textbf{samych zer}.
    \item musi być \textbf{unikalny} w segmencie sieci lokalnej.
\end{itemize}

Adres IP, który zawiera \textbf{same zera} w części hosta jest traktowany jako \textbf{adres sieci}.

\textbf{Adres ograniczonego rozgłoszenia - 255.255.255.255 = 11111111 11111111 11111111 11111111} -  adres rozgłoszenia
w danym segmencie sieci ograniczonym routerami.\\
\textbf{Adresy rozgłoszenia do sieci lub podsieci mają jedynki tylko w części hosta}.

\textbf{Adresy nieunikalne}, powtarzalne - przykłady:
\begin{itemize}
    \item adresy rozpoczynające się od liczby 127, które oznaczają zawsze komputer lokalny (zwykle 127.0.0.1).
    \item adresy tzw. transmisji grupowej.
    \item grupy tzw. adresów prywatnych.
\end{itemize}

\subsection{Adresowanie oparte na klasach}

Pierwszy bajt adresu determinuje do jakiej klasy należy sieć.

\begin{tabular}{|c|c|c|c|c|}
\hline
Klasa & Adres sieci & Adresy & Zakres 1-go bajtu & Najstarsze bity\\
\hline
A & w.0.0.0 & 1.0.0.0 - 126.0.0.0 & 1 – 126 & 0\\
\hline
B & w.x.0.0 & 128.0.0.0 - 191.255.0.0 & 128 – 191 & 10\\
\hline
C & w.x.y.0 & 192.0.0.0 - 223.255.255.0 & 192 – 223 & 110\\
\hline
D & nie dotyczy & nie dotyczy & 224 – 239 & 1110\\
\hline
E & nie dotyczy & nie dotyczy & 240 – 255 & 11110\\
\hline
\end{tabular}


\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
Klasa & Ilość sieci & Komp. w sieci & ID sieci & ID hosta & "pierwszy" & "ostatni"\\
\hline
A & 126 & $2^{24}-2$ & 1 bajt & 3 bajty & w.0.0.1 & w.255.255.254\\
\hline
B & $(191-128+1)*256$ & $2^{16}-2 = 65 534$ & 2 bajty & 2 bajty & w.x.0.1 & w.x.255.254\\
\hline
C & $(192-223+1)*256*256$ & $2^8 -2 = 254$ & 3 bajty & 1 bajt & w.x.z.1 & w.x.z.254\\
\hline
\end{tabular}

\begin{itemize}
\item \textbf{Adresy klasy D} - przeznaczone są do transmisji grupowych.
\item \textbf{Adresy klasy E} - zarezerwowane (nie wykorzystywane normalnie do transmisji pakietów).
\item \textbf{Adresy pętli zwrotnej} (loopback) - postaci 127.x.y.z (na ogół 127.0.0.1). Cały ruch przesyłany na ten adres nie wychodzi z komputera.
\end{itemize}

Identyfikator sieci można określić na podstawie adresu IP oraz tzw. \textbf{maski sieci}. Jest to \textbf{liczba binarna 32 bitowa}, zapisywana podobnie jak adres IP, jednak \textbf{maska zawsze z lewej strony ma jedynki, natomiast z prawej ma zera}.\\
Przykłady masek:\\
255.0.0.0 = 11111111.00000000.00000000.00000000 = /8,\\
255.255.0.0 = 11111111. 11111111.00000000.00000000 = /16.\\
\\
Adres sieci = AdresIP \& Maska\\


\textbf{Dzielenie sieci na podsieci}\\
Dzielenie sieci na fragmenty nazywane \textbf{podsieciami} w celu zwiększenia efektywności działania.
\begin{itemize}
    \item zmniejszenie ruchu w segmentach,
    \item zmniejszenoe tzw. dziedziny rozgłaszania (obszary przekazywania ramek rozgłoszeniowych,
    tj. z adresem MAC ff-ff-ff-ff-ff-ff-)
    \item zwiększenie bezpieczeństwa. Routery mogą działać jako filtry pakietów, które
    przepuszczają między sobą tylko pakiety spełniające określone kryteria.
\end{itemize}
Adres podsieci można określić przez użycie niestandardowych masek sieci (\textbf{masek podsieci}).

Dzielenie klasy A - maski 255.255.0.0, 255.255.255.0, dla B - 255.255.255.0.

Routery przechowują w tablicach routowania informacje o znanych im trasach do pewnych sieci. Administrator w trakcie konfiguracji routera wprowadza informacje o sieciach bezpośrednio przyłączonych do routera. Potem, po włączeniu opcji dynamicznego rutowania
routery wymieniają się informacjami o sieciach wg protokołów rutowania i na tej podstawie budują sobie pewien obraz
sieci i potrafią wyznaczać trasy datagramów.

Przykład: komputer A: 162.168.1.100, komputer B: 162.168.2.101\\
Maska 255.255.0.0 - komputery są względem siebie lokalne.\\
Maska 255.255.255.0 - komputery są względem siebie odległe (przedzielone routerem).

\subsection{Adresowanie bezklasowe}
Pytanie: czy nie można podzielić sieci na podsieci
z \textbf{użyciem dowolnej liczby jedynek}? Na przykład, jeśli w sieci klasy B o
adresie 149.159.0.0 /16 zastosowalibyśmy maskę podsieci nie 24 bitową (co daje 254 lub
256 podsieci z możliwością adresowania do 254 komputerów) tylko 22 bitową.
Otrzymalibyśmy 62 lub 64 sieci, z których każda mogłaby mieć 1022 komputery. Do określenia sieci należy podać adres
sieci oraz maskę. Obecnie w Internecie powszechnie jest wykorzystywane adresowanie
bezklasowe.
Przykład adresowania bezklasowego: 145.217.123.7 /20 (maska: 255.255.240.0)

\section{Model ISO/OSI}
OSI (Open Systems Interconnection) utworzony przez Międzynarodową Organizację
Normalizacyjną (ISO International Organization for Standarization w Genewie)
stanowi \textbf{model referencyjny} (wzorcowy).

\begin{itemize}
    \item ułatwienie zrozumienia procesów zachodzących podczas komunikowania się komputerów
    \item ułatwienie projektowania protokołów komunikacyjnych
\end{itemize}

\begin{tabular}{|c|c|}
\hline
\textbf{Numer warstwy} & \textbf{Nazwa warstwy}\\
\hline
7 & Aplikacji\\
\hline
6 & Prezentacji\\
\hline
5 & Sesji\\
\hline
4 & Transportu\\
\hline
3 & Sieci\\
\hline
2 & Łącza danych\\
\hline
1 & Fizyczna\\
\hline
\end{tabular}

Każdą z warstw można rozpatrywać w aspekcie dwóch zasadniczych funkcji: odbierania i
nadawania.
\begin{itemize}
\item \textbf{Warstwa fizyczna} - standard połączenia fizycznego, charakterystyki wydajnościowe nośników. Same media transmisyjne pozostają poza dziedziną jej
zainteresowania (czasem określane są terminem warstwa zerowa).
\item \textbf{Warstwa łącza danych} – grupowanie danych wejściowych (z warstwy fizycznej) w bloki zwane \textbf{ramkami} danych („jednostki
danych usług warstwy fizycznej”), mechanizmy kontroli poprawności
transmisji (FCS).
\item \textbf{Warstwa sieci} - określenie trasy przesyłania
danych między komputerami poza lokalnym segmentem sieci LAN, protokoły trasowane takie jak IP (ze stosu protokołów TCP/IP), IPX
(Novell IPX/SPX), DDP (AppleTalk) (adresowanie logiczne).
\item \textbf{Warstwa transportu} - kontrola błędów i przepływu danych
poza lokalnymi segmentami LAN, protokoły zapewniające
komunikację procesów uruchomionych na odległych komputerach (np. oprogramowanie klient/serwer), w tym komunikację z zapewnieniem
niezawodności dostarczania danych. Protokoły tej warstwy to np. TCP oraz UDP (z
TCP/IP), SPX (Novell IPX/SPX), ATP, NBP, AEP (AppleTalk).
\item \textbf{Warstwa sesji} - zarządzanie przebiegiem komunikacji podczas
połączenia między komputerami (sesji).
\item \textbf{Warstwa prezentacji} - kompresja, kodowanie i
translacja między niezgodnymi schematami kodowania oraz szyfrowanie.
\item \textbf{Warstwa aplikacji} - interfejs między aplikacjami a
usługami sieci.
\end{itemize}

Określona sesja komunikacyjna nie musi wykorzystywać protokołów ze wszystkich warstw
modelu. Przy nadawaniu dane kierowane są od warstwy 7 do 1, przy odbiorze od 1 do 7.

Używane są też inne modele warstwowe, np. jeden z takich
prostszych modeli – model TCP/IP – jest często wykorzystywany przy opisie zestawu (stosu)
protokołów TCP/IP (Internet). Nie ma warstwy prezentacji ani warstwy sesji, ponieważ zestaw TCP/IP nie zawiera
żadnych protokołów, które można byłoby przypisać do tych warstw. Nieco inny model
„dydaktyczny” został zaproponowany przez Tannenbauma.

\begin{tabular}{|c|c|c|c| }
\hline
Nr warstwy OSI & Nazwa warstwy OSI & Nazwa warstwy TCP/IP & Nazwa warstwy Tannenbaum\\
\hline
7 & Aplikacji & Aplikacji & Aplikacji\\
6 & Prezentacji & & \\
5 & Sesji & & \\
4 & Transportu & Transportu & Transportu\\
3 & Sieci & Intersieci & Sieci\\
2 & Łącza danych & Interfejsu sieciowego & Łącza danych\\
1 & Fizyczna & & Fizyczna\\
\hline
\end{tabular}

\section{Routing dynamiczny}
Sposób obsługi routowania przez warstwę IP to \textbf{mechanizm routowania} -
przeglądanie przez tablicy routowania, podejmowanie decyzji co do przesyłania datagramów IP.
Przez pojęcie \textbf{polityka routowania} określa się działania procesu routowania podejmowane w
celu ustanowienia i bieżącej modyfikacji tablicy routowania, jest ona realizowana z wykorzystaniem protokołów routowania.\\

Pożądane cechy protokołów routowania to:
\begin{itemize}
    \item Wyznaczenie \textbf{najlepszej trasy} do punktu docelowego, wymaga określenia kryterium porównywania tras.
    \item \textbf{Odporność} (robustness) - protokoły muszą zawsze działać poprawnie.
    \item \textbf{Szybkie osiągnięcie zbieżności} (rapid convergence), czyli stanu, w którym wszystkie routery „widzą” jednakowo topologię sieci.
Szybkość określa czas rozpowszechnienia informacji o zmianach.
    \item \textbf{Dopasowanie do zmian} (flexibility), wyznaczanie nowych optymalnych tras.
\end{itemize}

Internet jest zorganizowany jako grupa tzw. systemów autonomicznych (Autonomous
System – AS), z których każdy jest osobno administrowany. W każdym są wewnętrzne protokoły routowania (ang. IGP – interdomain gateway protocol lub IRP – interdomain routing protocol).\\

Ze względu na sposób działania protokoły routowania wewnętrznego dzielimy na:
\begin{itemize}
    \item protokoły \textbf{wektora odległości} (DV, distance-vector): RIP, RIP2, IGRP, EIGRP
    \item protokoły \textbf{stanu łącza} (link-state): OSPF, OSPF2, IS-IS, NLSP
\end{itemize}
Uwaga: w starszych opracowaniach firmy Cisco protokół EIGRP był określany jako protokół
hybrydowy.

\textbf{Zewnętrzne protokoły routowania} (EGP -bexterior gateway protocols) - międzydomenowe protokoły routowania używane między routerami działającymi w różnych systemach autonomicznych.
Najważniejszym protokołem zewnętrznym jest BGP.
Oprócz protokołów routowania rozważa się protokoły routowalne, takie jak IP, IPX, Apple
Talk. Określają sposoby adresowania, umożliwiające dostarczanie
pakietów w złożonej sieci komputerowej. Routery mogą wyznaczać trasy dla różnych
protokołów routowalnych, nie tylko IP. Każdy z protokołów routowania i każdy z protokołów
routowalnych musi być w routerze skonfigurowany.

\subsection{Protokoły routowania wektora odległości}
Distance vector – wektor odległości. Protokoły wektora odległości są oparte na \textbf{algorytmie Bellmana Forda} obliczania najkrótszych ścieżek w grafie.\\
Węzły grafu oznaczają routery, krawędzie odpowiadają połączeniom między routerami.
Połączenia te mają różne koszty, co odpowiada różnym wagom krawędzi grafu.
W protokołach routowania wagi nie mogą być ujemne, co oznacza, że można też
wykorzystać np. algorytm Dijkstry (jest wykorzystywany w protokołach stanu łącza).\\

Nie zawsze router jest w stanie wykryć uszkodzenie łącza. Uszkodzeniu
może ulec też np. sąsiedni router albo ramka zawierająca pakiet z wektorem odległości i wektor
odległości nie dotrze do docelowego routera. Dlatego w protokołach typu wektor odległości
trasa jest zaznaczana jako niedostępna, gdy router nie dostanie o niej informacji od sąsiada
przez kilka kolejnych rozgłoszeń (np. w RIP 180 sekund, czyli sześć
rozgłoszeń). Trasa niedostępna nie jest jeszcze usuwana z tablicy routowania przez
kilka rozgłoszeń, np. w RIP przez 90 sekund. Powoduje to większe opóźnienie w czasie uzyskania zbieżności.\\

\subsection{Niekorzystne zjawiska związane z routowaniem wg protokołów wektora odległości}
\begin{itemize}
    \item Pętle routowania.
    \item Efekt odbijania.
    \item Zliczanie do nieskończoności.
\end{itemize}

Taktyki rozwiązania:
\begin{itemize}
    \item \textbf{Dzielony horyzont (split horizon)}
    \begin{itemize}
        \item \textbf{Do łącza nie zostanie przekazana informacja o trasach wiodących przez to łącze}.
        \item Dzielony horyzont nie zawsze, ale zazwyczaj likwiduje \textbf{pętle routowania}.
    \end{itemize}

    \item \textbf{Natychmiastowe/wymuszane aktualizacje (triggered updates)}
    \begin{itemize}
        \item W przypadku zmiany metryki trasy \textbf{musi nastąpić rozgłoszenie bez względu na okres
    rozgłoszeń} charakterystyczny dla danego protokołu.
        \item Powoduje to \textbf{szybszą zbieżność} i częściowo zapobiega \textbf{pętlom routowania}.
    \end{itemize}

    \item \textbf{Zegary hold-down (hold-down timers)}
    \begin{itemize}
        \item Router po otrzymaniu od sąsiada informacji o dezaktualizacji trasy włącza \textbf{specjalny zegar} (hold-down timer).
        \item Jeśli przed upływem czasu progowego nastąpi:
        \begin{itemize}
            \item \textbf{aktualizacja od tego samego sąsiada} na trasę aktywną, to \textbf{trasa} jest zaznaczana jako \textbf{aktywna}.
            \item router dostanie \textbf{od innego routera informację} o trasie do rozważanego miejsca docelowego z \textbf{metryką mniejszą bądź równą} tej zdezaktualizowanej, wówczas następuje \textbf{wpis zgłoszonej trasy}.
            \item router dostanie \textbf{od innego routera informację} o trasie do rozważanego miejsca docelowego z \textbf{metryką większą} od tej zdezaktualizowanej, taka trasa \textbf{nie jest brana pod uwagę}.
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{Protokół RIP}
\begin{itemize}
    \item Protokół typu wektor odległości.

    \item Metryką w RIP jest liczba skoków (hops) do celu. Można skonfigurować inne wartości dla połączeń, więc np. preferencję tras szybszych.

    \item Metryka 16 oznacza umownie nieskończoność (miejsce niedostępne), zatem RIP nie jest dobrym protokołem w przypadku dużych sieci.

    \item Można ustawić trasę domyślną (adres 0.0.0.0).

    \item W wersji RIP na routerach Cisco można przechowywać więcej niż jedną trasę o
    takiej samej metryce. Można włączyć równoważenie obciążeń (load balancing) na dwa
    sposoby:
    \begin{itemize}
        \item \textbf{Process switching} (packet-by-packet load balancing), kosztowny i dlatego nie polecany, każdy pakiet jest kierowany osobno, dla każdego jest przeglądana tablica routowania.
        \item \textbf{Fast switching} (destination-by-destination), tylko dla pierwszego pakietu z pewnego miejsca źródłowego do pewnego miejsca docelowego przeszukiwana jest tablica routowania. Wyznaczona trasa jest zapisywana w pamięci podręcznej (cache) i kolejne pakiety wędrują tą samą ścieżką.
    \end{itemize}

    \item Wykorzystywane są następujące \textbf{mechanizmy} typowe dla protokołów wektor odległości:
    \begin{itemize}
        \item Split horizon (+ with poison reverse)
        \item Holddown counters (timers)
        \item Triggered updates
    \end{itemize}

    \item \textbf{Cztery zegary, liczniki} (timers, counters):
    \begin{itemize}
        \item \textbf{Update timer} (standardowo 30 sekund) – po przesłaniu wektora odległości
        (routing update) zegar jest zerowany. Po osiągnięciu 30 s. wysyłany jest następny wektor.
        \item \textbf{Invalid timer} (standardowo 180 sekund) – za każdym razem jak router dostaje uaktualnienie pewnej trasy zegar ten dla trasy jest zerowany. Po osiągnięciu wartości progowej trasa jest zaznaczana jako niepoprawna, ale pakiety jeszcze są kierowane tą trasą.
        \item \textbf{Hold-down timer} (standardowo 180s.) – po przekroczeniu wartości progowej
        przez invalid timer trasa jest ustawiana w stan hold-down. Trasa jest ustawiana w stan holddown również gdy router dostanie informację o tym, że sieć jest nieosiągalna (i nie ma innej, osiągalnej trasy).
        \item \textbf{Flush-timer} (standardowo 240s.) – zegar dla trasy jest zerowany po otrzymaniu informacji o trasie. Po osiągnięciu czasu progowego trasa jest usuwana nawet, jeśli trasa jest jeszcze w stanie hold-down.
    \end{itemize}

    \item Przewidziano możliwość \textbf{odpytywania routera o cały wektor odległości} lub o \textbf{trasy} do pewnych miejsc docelowych – takie możliwości są wykorzystywane prze starcie oraz na ogół w celach diagnostycznych.\\

    \item \textbf{Zalety RIP}
    \begin{itemize}
        \item prostota - procesor nie jest nadmiernie obciążony aktualizacją tablicy routowania i innymi działaniami,
        \item łatwość konfiguracji.
    \end{itemize}

    \item \textbf{Wady RIP}
    \begin{itemize}
        \item wolne rozprzestrzenianie się informacji o zmianach w topologii sieci (wolna zbieżność),
        \item stosunkowo częste (co 30s.) przesyłanie dużych porcji informacji w komunikatach RIP, co obciąża sieć.
        \item Wadą RIPv1 jest to, że nie daje możliwości przesyłania masek. RIP w wersji 1 jest protokołem routowania klasowego. Przyjmowana jest maska taka, jaka jest ustawiona na interfejsie, do którego dotarł wektor odległości z tą informacją. Na granicach klas jednak routery RIP wykonują automatyczną sumaryzację, co przy niepoprawnych konfiguracjach może prowadzić do błędów w routowaniu.
    \end{itemize}

    \item RIPv2 przekazuje maski podsieci, można stosować sieci bezklasowe i podsieci o zmiennym rozmiarze. Umożliwia prostą autentykację (przez hasła). Przekazuje adresy następnego skoku w komunikatach. Część wad RIP pozostała: 16 jako metryka oznaczająca nieskończoność, brak alternatywnych tras.
\end{itemize}

\subsection{Wiele protokołów routowania. Odległości administracyjne.}
W środowisku współdziałania wielu protokołów routowania dla tras, w zależności od tego
jakie jest ich źródło, ustawiana jest tzw. \textbf{odległość administracyjna}. Odległość jest używana tylko \textbf{wewnętrznie przez router}, wybierane są trasy o \textbf{najmniejszej odległości}.\\

Standardowe odległości dla tras:\\
\begin{tabular}{|c|c|}
    \hline
    Źródło trasy & Odległość administracyjna\\
    \hline
    Connected interface & 0\\
    \hline
    Static route & 1\\
    \hline
    Summary EIGRP & 5\\
    \hline
    External BGP & 20\\
    \hline
    Internal EIGRP & 90\\
    \hline
    IGRP & 100\\
    \hline
    OSPF & 110\\
    \hline
    IS-IS & 115\\
    \hline
    RIP & 120\\
    \hline
    EGP & 140\\
    \hline
    Internal BGP & 200\\
    \hline
    Unknown & 255\\
    \hline
\end{tabular}

Na routerach można również włączyć redystrybucję tras między protokołami routowania
według różnych zasad, z odpowiednim przeliczaniem metryk.

\end{document}
